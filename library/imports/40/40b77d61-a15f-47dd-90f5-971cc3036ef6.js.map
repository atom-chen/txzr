{"version":3,"sources":["../../../../../assets/script/scene/assets/script/scene/BattleScene.ts"],"names":[],"mappings":";;;;;AAAA;;GAEG;AACH,+CAA0C;AAC1C,wDAAmD;AAEnD,sDAA+C;AAC/C,uDAAqD;AACrD,uCAAkC;AAE5B,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAQ,CAAiB;AAGzC;IAAyC,+BAAS;IADlD;QAAA,qEAsFC;QAnFW,mBAAa,GAAgB,EAAE,CAAA;;IAmF3C,CAAC;IAnEU,4BAAM,GAAb;QAAA,iBAeC;QAdG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,EAAE,cAAM,OAAA,CAAC,KAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAhB,CAAgB,CAAC,CAAA;QACpD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,cAAM,OAAA,CAAC,KAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAhB,CAAgB,CAAC,CAAA;QACrD,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;QAEzD,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAA;QAC9E,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAA;QAE5E,IAAI,CAAC,QAAQ,EAAE,CAAA;QAEf,kBAAkB;QAClB,6CAA6C;QAC7C,0BAA0B;QAC1B,gBAAgB;QAChB,KAAK;IACT,CAAC;IAEM,8BAAQ,GAAf;QAAA,iBAcC;QAbG,eAAK,CAAC,SAAS,CAAC,0BAA0B,CAAC,CAAC,IAAI,CAAC,UAAC,IAAa;YAC3D,KAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;YAC3B,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAA;QAC7C,CAAC,CAAC,CAAA;QAEF,wEAAwE;QACxE,kCAAkC;QAClC,KAAK;QAEL,wEAAwE;QACxE,kCAAkC;QAClC,KAAK;IAET,CAAC;IAEO,4BAAM,GAAd,UAAe,IAAI;QACf,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;IACvC,CAAC;IAEO,mCAAa,GAArB,UAAsB,KAAK;QACvB,IAAI,KAAK,CAAC,IAAI,KAAK,SAAS,EAAE;YAC1B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;YACnB,OAAM;SACT;QACD,QAAO,KAAK,CAAC,OAAO,EAAE;YAClB,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;YACpB,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI;gBAClB,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAA;gBAClB,MAAK;YACT,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;YACpB,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK;gBACnB,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAA;gBAChB,MAAK;YACT,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;YACpB,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI;gBAClB,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAA;gBAClB,MAAK;YACT,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;YACpB,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE;gBAChB,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAA;gBACjB,MAAK;SACZ;IACL,CAAC;IAEO,8BAAQ,GAAhB,UAAiB,KAAK;QAClB,eAAG,CAAC,KAAK,CAAC,CAAA;QACV,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;IAC1C,CAAC;IAjFD;QADC,QAAQ,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;sDACiB;IAKvC;QADC,mBAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;gDACM;IAG1B;QADC,mBAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;iDACO;IAG3B;QADC,mBAAQ,CAAC,qBAAW,CAAC;iDACO;IAG7B;QADC,mBAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;gDACM;IAhBP,WAAW;QAD/B,OAAO;OACa,WAAW,CAqF/B;IAAD,kBAAC;CArFD,AAqFC,CArFwC,mBAAS,GAqFjD;kBArFoB,WAAW","file":"","sourceRoot":"../../../../../assets/script/scene","sourcesContent":["/**\n * 战斗场景\n */\nimport BaseScene from \"../core/BaseScene\";\nimport JoyStickCmp from \"../component/JoyStickCmp\";\nimport HeroCtrl from \"../ctrl/battle/HeroCtrl\";\nimport { log } from \"../core/helper/LogHelper\";\nimport { autoBind } from \"../core/decorator/AutoBind\"\nimport Utils from \"../util/Utils\";\n\nconst {ccclass, property} = cc._decorator\n\n@ccclass\nexport default class BattleScene extends BaseScene {\n    @property([cc.Prefab])\n    private preloadPrefab: cc.Prefab[] = []\n\n    private hero: HeroCtrl\n\n    @autoBind(cc.Button)\n    private fireBtn: cc.Button\n\n    @autoBind(cc.Button)\n    private fireBtn2: cc.Button\n\n    @autoBind(JoyStickCmp)\n    private joyStick: JoyStickCmp\n\n    @autoBind(cc.Node)\n    private bgLayer: cc.Node\n\n    public onLoad() {\n        this.bindTouch(this.fireBtn, () => (this.onFire(1)))\n        this.bindTouch(this.fireBtn2, () => (this.onFire(2)))\n        this.joyStick.setChangeListener(this.joyEvent.bind(this))\n        \n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.keyBoardEvent, this)\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.keyBoardEvent, this)\n\n        this.loadHero()\n\n        // Utils.loading()\n        // this.send(Msg.REQ_BATTLE, {}).then(() => {\n        //     Utils.hideLoading()\n        //     log('开始')\n        // })\n    }\n\n    public loadHero() {\n        Utils.insPrefab('prefab/battle/HeroPrefab').then((node: cc.Node) => {\n            this.bgLayer.addChild(node)\n            this.hero = node.getComponent('HeroCtrl')\n        })\n\n        // Utils.insPrefab('prefab/battle/HeroPrefab').then((node: cc.Node) => {\n        //     this.bgLayer.addChild(node)\n        // })\n\n        // Utils.insPrefab('prefab/battle/HeroPrefab').then((node: cc.Node) => {\n        //     this.bgLayer.addChild(node)\n        // })\n\n    }\n\n    private onFire(type) {\n        this.hero && this.hero.attack(type)\n    }\n\n    private keyBoardEvent(event) {\n        if (event.type !== \"keydown\") {\n            this.joyEvent(null)\n            return \n        }\n        switch(event.keyCode) {\n            case cc.macro.KEY.a:\n            case cc.macro.KEY.left:\n                this.joyEvent(180)\n                break\n            case cc.macro.KEY.d:\n            case cc.macro.KEY.right:\n                this.joyEvent(0)\n                break\n            case cc.macro.KEY.s:\n            case cc.macro.KEY.down:\n                this.joyEvent(270)\n                break\n            case cc.macro.KEY.w:\n            case cc.macro.KEY.up:\n                this.joyEvent(90)\n                break\n        }\n    }\n\n    private joyEvent(angel) {\n        log(angel)\n        this.hero && this.hero.heroMove(angel)\n    }\n\n}"]}